I used a corpus of H.P. Lovecraft's stories, because I like Lovecraft and I already had the corpus on hand. I pulled one of the stories out and used a bit of it for testing. Rather than use separate lists of lists for the probabilities and the backpointer, I used one list of lists and stored both the probabilities and the backpointers in tuples. The pseudocode in the textbook seems to assume that the [start] of the sequence will be part of the viterbi matrix, because it starts at index 1. I found it easier to use a special case for the first row. I also didn't use the FreqDist provided in the code, and wrote my own code for tallying things up. I did this because I simply didn't notice the FreqDist was there until it was too late.